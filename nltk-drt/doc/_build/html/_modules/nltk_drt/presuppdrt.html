
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>nltk_drt.presuppdrt &#8212; NLTK-DRT Extension  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for nltk_drt.presuppdrt</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">NLTK DRT module extended with presuppositions</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Alex Kislev, Emma Li, Peter Makarov&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;1.0&quot;</span>
<span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;Tue, 24 Aug 2010&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">operator</span>

<span class="kn">from</span> <span class="nn">nltk.sem.logic</span> <span class="kn">import</span> <span class="n">Variable</span>
<span class="kn">from</span> <span class="nn">nltk.sem.logic</span> <span class="kn">import</span> <span class="n">EqualityExpression</span><span class="p">,</span> <span class="n">ApplicationExpression</span><span class="p">,</span> <span class="n">ExistsExpression</span><span class="p">,</span> <span class="n">AndExpression</span>
<span class="kn">from</span> <span class="nn">nltk.sem.logic</span> <span class="kn">import</span> <span class="n">IndividualVariableExpression</span>
<span class="kn">from</span> <span class="nn">nltk.sem.logic</span> <span class="kn">import</span> <span class="n">_counter</span><span class="p">,</span> <span class="n">is_eventvar</span><span class="p">,</span> <span class="n">is_funcvar</span>
<span class="kn">from</span> <span class="nn">nltk.sem.logic</span> <span class="kn">import</span> <span class="n">BasicType</span>
<span class="kn">from</span> <span class="nn">nltk.sem.logic</span> <span class="kn">import</span> <span class="n">Expression</span>
<span class="kn">from</span> <span class="nn">nltk.sem.logic</span> <span class="kn">import</span> <span class="n">LogicalExpressionException</span>
<span class="kn">from</span> <span class="nn">nltk.sem.drt</span> <span class="kn">import</span> <span class="n">DrsDrawer</span><span class="p">,</span> <span class="n">AnaphoraResolutionException</span>
<span class="c1">#from nltk.sem.drt import DrtConcatenation</span>

<span class="c1"># additional imports</span>
<span class="kn">from</span> <span class="nn">nltk.sem.logic</span> <span class="kn">import</span> <span class="n">ImpExpression</span><span class="p">,</span> <span class="n">IffExpression</span><span class="p">,</span> <span class="n">APP</span>


<span class="kn">import</span> <span class="nn">nltk.sem.drt</span> <span class="k">as</span> <span class="nn">drt</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>

<span class="c1">#from copy import deepcopy</span>
<span class="kn">import</span> <span class="nn">copy</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="o">*</span>


<div class="viewcode-block" id="TimeType"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.TimeType">[docs]</a><span class="k">class</span> <span class="nc">TimeType</span><span class="p">(</span><span class="n">BasicType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Basic type of times added on top of nltk.sem.logic.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="TimeType.__str__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.TimeType.__str__">[docs]</a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;i&#39;</span></div>

    <span class="k">def</span> <span class="nf">str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;TIME&#39;</span></div>

<span class="n">TIME_TYPE</span> <span class="o">=</span> <span class="n">TimeType</span><span class="p">()</span>

<div class="viewcode-block" id="StateType"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.StateType">[docs]</a><span class="k">class</span> <span class="nc">StateType</span><span class="p">(</span><span class="n">BasicType</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Basic type of states added on top of nltk.sem.logic.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="StateType.__str__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.StateType.__str__">[docs]</a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;s&#39;</span></div>

    <span class="k">def</span> <span class="nf">str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;STATE&#39;</span></div>

<span class="n">STATE_TYPE</span> <span class="o">=</span> <span class="n">StateType</span><span class="p">()</span>

<div class="viewcode-block" id="is_indvar"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.is_indvar">[docs]</a><span class="k">def</span> <span class="nf">is_indvar</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;An individual variable must be a single lowercase character other than &#39;e&#39;, &#39;t&#39;, &#39;n&#39;, &#39;s&#39;,</span>
<span class="sd">    followed by zero or more digits.</span>

<span class="sd">    :param expr: expression</span>
<span class="sd">    :type expr: str</span>
<span class="sd">    :return: True if expr is of the correct form</span>
<span class="sd">    :rtype: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a string&quot;</span> <span class="o">%</span> <span class="n">expr</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[a-df-mo-ru-z]\d*$&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span></div>

<div class="viewcode-block" id="is_timevar"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.is_timevar">[docs]</a><span class="k">def</span> <span class="nf">is_timevar</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;An time variable must be a single lowercase &#39;t&#39; or &#39;n&#39; character followed by</span>
<span class="sd">    zero or more digits. Do we need a separate type for utterance time n?</span>

<span class="sd">    :param expr: expression</span>
<span class="sd">    :type expr: str</span>
<span class="sd">    :return: True if expr is of the correct form</span>
<span class="sd">    :rtype: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a string&quot;</span> <span class="o">%</span> <span class="n">expr</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[tn]\d*$&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span></div>


<div class="viewcode-block" id="is_statevar"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.is_statevar">[docs]</a><span class="k">def</span> <span class="nf">is_statevar</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;An state variable must be a single lowercase &#39;s&#39; character followed by</span>
<span class="sd">    zero or more digits.</span>

<span class="sd">    :param expr: expression</span>
<span class="sd">    :type expr: str</span>
<span class="sd">    :return: True if expr is of the correct form</span>
<span class="sd">    :rtype: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a string&quot;</span> <span class="o">%</span> <span class="n">expr</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^s\d*$&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span></div>


<div class="viewcode-block" id="is_uttervar"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.is_uttervar">[docs]</a><span class="k">def</span> <span class="nf">is_uttervar</span><span class="p">(</span><span class="n">expr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;An utterance time variable must be a single lowercase &#39;n&#39; character followed by</span>
<span class="sd">    zero or more digits.</span>

<span class="sd">    :param expr: expression</span>
<span class="sd">    :type expr: str</span>
<span class="sd">    :return: True if expr is of the correct form</span>
<span class="sd">    :rtype: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a string&quot;</span> <span class="o">%</span> <span class="n">expr</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^n\d*$&#39;</span><span class="p">,</span> <span class="n">expr</span><span class="p">)</span></div>


<div class="viewcode-block" id="unique_variable"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.unique_variable">[docs]</a><span class="k">def</span> <span class="nf">unique_variable</span><span class="p">(</span><span class="n">pattern</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Variable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ignore</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="n">Variable</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Variable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Return a new, unique variable.</span>

<span class="sd">    :param pattern: ``Variable`` that is being replaced.  The new variable must be the same type.</span>
<span class="sd">    :type pattern: Variable</span>
<span class="sd">    :param ignore: a set of ``Variable`` that should not be returned from this function.</span>
<span class="sd">    :type ignore: Set[Variable]</span>
<span class="sd">    :rtype: Variable</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pattern</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_indvar</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span>
        <span class="k">elif</span> <span class="n">is_funcvar</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;F&#39;</span>
        <span class="k">elif</span> <span class="n">is_eventvar</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;e0&#39;</span>
        <span class="k">elif</span> <span class="n">is_timevar</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;t0&#39;</span>
        <span class="k">elif</span> <span class="n">is_statevar</span><span class="p">(</span><span class="n">pattern</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;s0&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Cannot generate a unique constant&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;z&#39;</span>

    <span class="n">v</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">_counter</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
    <span class="k">while</span> <span class="n">ignore</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ignore</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">_counter</span><span class="o">.</span><span class="n">get</span><span class="p">()))</span>
    <span class="k">return</span> <span class="n">v</span></div>

<div class="viewcode-block" id="TimeVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.TimeVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">TimeVariableExpression</span><span class="p">(</span><span class="n">IndividualVariableExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class represents variables that take the form of a single lowercase</span>
<span class="sd">    &#39;i&#39; character followed by zero or more digits.</span>

<span class="sd">    :classes: `IndividualVariableExpression`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">TIME_TYPE</span></div>

<div class="viewcode-block" id="StateVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.StateVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">StateVariableExpression</span><span class="p">(</span><span class="n">IndividualVariableExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class represents variables that take the form of a single lowercase</span>
<span class="sd">    &#39;s&#39; character followed by zero or more digits.</span>
<span class="sd">    </span>
<span class="sd">    :classes: `IndividualVariableExpression`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="n">STATE_TYPE</span></div>

<div class="viewcode-block" id="is_unary_predicate"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.is_unary_predicate">[docs]</a><span class="k">def</span> <span class="nf">is_unary_predicate</span><span class="p">(</span><span class="n">expr</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check whether the given expression is an unary predicate</span>
<span class="sd">    </span>
<span class="sd">    :classes: `IndividualVariableExpression`&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">DrtApplicationExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtAbstractVariableExpression</span><span class="p">)</span></div>


<div class="viewcode-block" id="Reading"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.Reading">[docs]</a><span class="k">class</span> <span class="nc">Reading</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A single reading, consists of a list of operations</span>
<span class="sd">    each operation is a tuple of a DRS and a function,</span>
<span class="sd">    where the function would be executed on the given DRS</span>
<span class="sd">    when the reading is generated</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="Binding"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.Binding">[docs]</a><span class="k">class</span> <span class="nc">Binding</span><span class="p">(</span><span class="n">Reading</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Binding</span>
<span class="sd">    </span>
<span class="sd">    :classes: `Reading`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="LocalAccommodation"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.LocalAccommodation">[docs]</a><span class="k">class</span> <span class="nc">LocalAccommodation</span><span class="p">(</span><span class="n">Reading</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Local accomodation</span>

<span class="sd">    :classes: `Reading`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="IntermediateAccommodation"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.IntermediateAccommodation">[docs]</a><span class="k">class</span> <span class="nc">IntermediateAccommodation</span><span class="p">(</span><span class="n">Reading</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Intermediate accomodation</span>
<span class="sd">    </span>
<span class="sd">    :classes: `Reading`&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="GlobalAccommodation"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.GlobalAccommodation">[docs]</a><span class="k">class</span> <span class="nc">GlobalAccommodation</span><span class="p">(</span><span class="n">Reading</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Global accomodation</span>
<span class="sd">    </span>
<span class="sd">    :classes: `Reading`&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="ResolutionException"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.ResolutionException">[docs]</a><span class="k">class</span> <span class="nc">ResolutionException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="DrtTokens"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtTokens">[docs]</a><span class="k">class</span> <span class="nc">DrtTokens</span><span class="p">(</span><span class="n">drt</span><span class="o">.</span><span class="n">DrtTokens</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extended tokens from ``drt.DrtTokens``&quot;&quot;&quot;</span>
    <span class="n">OPEN_BRACE</span> <span class="o">=</span> <span class="s1">&#39;{&#39;</span>
    <span class="n">CLOSE_BRACE</span> <span class="o">=</span> <span class="s1">&#39;}&#39;</span>
    <span class="n">PUNCT</span> <span class="o">=</span> <span class="p">[</span><span class="n">OPEN_BRACE</span><span class="p">,</span> <span class="n">CLOSE_BRACE</span><span class="p">]</span>
    <span class="n">SYMBOLS</span> <span class="o">=</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">SYMBOLS</span> <span class="o">+</span> <span class="n">PUNCT</span>
    <span class="n">TOKENS</span> <span class="o">=</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">TOKENS</span> <span class="o">+</span> <span class="n">PUNCT</span>
    <span class="n">NEWINFO_DRS</span> <span class="o">=</span> <span class="s1">&#39;NEWINFO&#39;</span>
    <span class="n">PROPER_NAME_DRS</span> <span class="o">=</span> <span class="s1">&#39;PROP&#39;</span>
    <span class="n">DEFINITE_DESCRIPTION_DRS</span> <span class="o">=</span> <span class="s1">&#39;DEF&#39;</span>
    <span class="n">PRONOUN_DRS</span> <span class="o">=</span> <span class="s1">&#39;PRON&#39;</span>
    <span class="n">PRESUPPOSITION_DRS</span> <span class="o">=</span> <span class="p">[</span><span class="n">PROPER_NAME_DRS</span><span class="p">,</span> <span class="n">DEFINITE_DESCRIPTION_DRS</span><span class="p">,</span> <span class="n">PRONOUN_DRS</span><span class="p">]</span>
    <span class="n">PRONOUN</span> <span class="o">=</span> <span class="s1">&#39;PRO&#39;</span>
    <span class="n">REFLEXIVE_PRONOUN</span> <span class="o">=</span> <span class="s1">&#39;RPRO&#39;</span>
    <span class="n">POSSESSIVE_PRONOUN</span> <span class="o">=</span> <span class="s1">&#39;PPRO&#39;</span>
    <span class="c1"># ??</span>
    <span class="n">OLD_NLTK</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">NLTK</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">PROVER9</span>  <span class="o">=</span> <span class="mi">2</span></div>



<div class="viewcode-block" id="DrtExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtExpression</span><span class="p">(</span><span class="n">drt</span><span class="o">.</span><span class="n">DrtExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A base abstract DRT Expression from which every DRT Expression inherits.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">applyto</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtApplicationExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtNegatedExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s1">&#39;DrtExpression&#39;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DrtExpression</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DrtOrExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

<div class="viewcode-block" id="DrtExpression.__gt__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtExpression.__gt__">[docs]</a>    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DrtExpression</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DrtImpExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtExpression.__lt__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtExpression.__lt__">[docs]</a>    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">DrtExpression</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DrtIffExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtConcatenation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span>

<div class="viewcode-block" id="DrtExpression.make_EqualityExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtExpression.make_EqualityExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_EqualityExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">:</span> <span class="s1">&#39;DrtExpression&#39;</span><span class="p">,</span> <span class="n">second</span><span class="p">:</span> <span class="s1">&#39;DrtExpression&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method serves as a hook for other logic parsers that have different equality expression classes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DrtEqualityExpression</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtExpression.make_VariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtExpression.make_VariableExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_VariableExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">:</span> <span class="s1">&#39;Variable&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Make variable expression&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtExpression.normalize"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtExpression.normalize">[docs]</a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rename auto-generated unique variables&quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^z\d+$&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^[est]0\d+$&#39;</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                    <span class="k">return</span> <span class="nb">set</span><span class="p">([</span><span class="n">e</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">set</span><span class="p">([])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">combinator</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span> <span class="n">parts</span><span class="p">:</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">or_</span><span class="p">,</span> <span class="n">parts</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">visit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">combinator</span><span class="p">,</span> <span class="nb">set</span><span class="p">())</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="bp">self</span><span class="p">)))):</span>
            <span class="k">if</span> <span class="n">is_eventvar</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">newVar</span> <span class="o">=</span> <span class="s1">&#39;e0</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">is_timevar</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">newVar</span> <span class="o">=</span> <span class="s1">&#39;t0</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">is_statevar</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="n">newVar</span> <span class="o">=</span> <span class="s1">&#39;s0</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newVar</span> <span class="o">=</span> <span class="s1">&#39;z</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">v</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">make_VariableExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">newVar</span><span class="p">)),</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="DrtExpression.substitute_bindings"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtExpression.substitute_bindings">[docs]</a>    <span class="k">def</span> <span class="nf">substitute_bindings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bindings</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s1">&#39;DrtExpression&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Substitute bindings. TODO&quot;&quot;&quot;</span>
        <span class="n">expr</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">expr</span><span class="o">.</span><span class="n">variables</span><span class="p">():</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">bindings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">val</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Variable</span><span class="p">):</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">Expression</span><span class="p">):</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">substitute_bindings</span><span class="p">(</span><span class="n">bindings</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">DrtFeatureExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Can not substitute a non-expression &#39;</span>
                                         <span class="s1">&#39;value into an expression: </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,))</span>
                <span class="n">expr</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">expr</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span></div>

    <span class="n">RESOLUTION_ORDER</span> <span class="o">=</span> <span class="p">{</span><span class="n">Binding</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">GlobalAccommodation</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                        <span class="n">IntermediateAccommodation</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">LocalAccommodation</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>

<div class="viewcode-block" id="DrtExpression.resolve"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtExpression.resolve">[docs]</a>    <span class="k">def</span> <span class="nf">resolve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inference_check</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method does the whole job of collecting multiple readings.</span>
<span class="sd">        We aim to get new readings from the old ones by resolving</span>
<span class="sd">        presuppositional DRSs one by one. Every time one presupposition</span>
<span class="sd">        is resolved, new readings are created and replace the old ones,</span>
<span class="sd">        until there are no presuppositions left to resolve.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">readings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">inference_check</span><span class="p">:</span>
            <span class="n">failed_readings</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">def</span> <span class="nf">traverse</span><span class="p">(</span><span class="n">base_reading</span><span class="p">,</span> <span class="n">operations</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">operation</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">operations</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="n">DrtExpression</span><span class="o">.</span><span class="n">RESOLUTION_ORDER</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">o</span><span class="p">)]):</span>
                <span class="n">new_reading</span> <span class="o">=</span> <span class="n">base_reading</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operation</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;reading: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">new_reading</span><span class="p">))</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">new_operations</span> <span class="o">=</span> <span class="n">new_reading</span><span class="o">.</span><span class="n">readings</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">ex</span><span class="p">:</span>
                    <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ex</span><span class="p">))</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">new_operations</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">inference_check</span><span class="p">:</span>
                        <span class="n">success</span><span class="p">,</span> <span class="n">error</span> <span class="o">=</span> <span class="n">inference_check</span><span class="p">(</span><span class="n">new_reading</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
                            <span class="n">readings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_reading</span><span class="p">)</span>
                            <span class="k">return</span> <span class="kc">True</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">failed_readings</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">new_reading</span><span class="p">,</span> <span class="n">error</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">readings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_reading</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">traverse</span><span class="p">(</span><span class="n">new_reading</span><span class="p">,</span> <span class="n">new_operations</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">operations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">DrtExpression</span><span class="o">.</span><span class="n">RESOLUTION_ORDER</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">operation</span><span class="p">)]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="k">return</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">operations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">readings</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">operations</span><span class="p">:</span>
            <span class="n">traverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">readings</span> <span class="ow">and</span> <span class="n">errors</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ResolutionException</span><span class="p">(</span><span class="s2">&quot;. &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">errors</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">readings</span><span class="p">,</span> <span class="n">failed_readings</span> <span class="k">if</span> <span class="n">inference_check</span> <span class="k">else</span> <span class="n">readings</span></div>

    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>


<div class="viewcode-block" id="DRS"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DRS">[docs]</a><span class="k">class</span> <span class="nc">DRS</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DRS</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A Temporal Discourse Representation Structure.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot convert DRS with no conditions to FOL.&quot;</span><span class="p">)</span>
        <span class="n">accum</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">AndExpression</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">):</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="n">ExistsExpression</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">AndExpression</span><span class="p">(</span><span class="n">accum</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ref_type</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span><span class="o">.</span><span class="n">fol</span><span class="p">()))</span>
        <span class="k">return</span> <span class="n">accum</span>

    <span class="k">def</span> <span class="nf">_ref_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">referent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Checks a referent type and returns corresponding predicate&quot;&quot;&quot;</span>
        <span class="n">ref_cond</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">is_eventvar</span><span class="p">(</span><span class="n">referent</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">ref_cond</span> <span class="o">=</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtConstantExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;event&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">is_statevar</span><span class="p">(</span><span class="n">referent</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">ref_cond</span> <span class="o">=</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtConstantExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;state&quot;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">is_timevar</span><span class="p">(</span><span class="n">referent</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="n">ref_cond</span> <span class="o">=</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtConstantExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ref_cond</span> <span class="o">=</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtConstantExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="s2">&quot;individual&quot;</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">DrtApplicationExpression</span><span class="p">(</span><span class="n">ref_cond</span><span class="p">,</span> <span class="n">DrtAbstractVariableExpression</span><span class="p">(</span><span class="n">referent</span><span class="p">))</span>


    <span class="sd">&#39;&#39;&#39;def replace(self, variable, expression, replace_bound=False):</span>
<span class="sd">        &quot;&quot;&quot;Replace all instances of variable v with expression E in self,</span>
<span class="sd">        where v is free in self.&quot;&quot;&quot;</span>
<span class="sd">        if variable in self.get_refs():</span>
<span class="sd">            #if a bound variable is the thing being replaced</span>
<span class="sd">            if not replace_bound:</span>
<span class="sd">                return self</span>
<span class="sd">            else:</span>
<span class="sd">                if variable in self.refs:</span>
<span class="sd">                    i = self.refs.index(variable)</span>
<span class="sd">                    refs = self.refs[:i] + [expression.variable] + self.refs[i + 1:]</span>
<span class="sd">                else:</span>
<span class="sd">                    refs = self.refs</span>
<span class="sd">                return self.__class__(refs,</span>
<span class="sd">                           [cond.replace(variable, expression, True) for cond in self.conds])</span>
<span class="sd">        else:</span>
<span class="sd">            #variable not bound by this DRS</span>

<span class="sd">            # any bound variable that appears in the expression must</span>
<span class="sd">            # be alpha converted to avoid a conflict</span>
<span class="sd">            for ref in (set(self.get_refs()) &amp; expression.free()):</span>
<span class="sd">                newvar = unique_variable(ref)</span>
<span class="sd">                newvarex = DrtVariableExpression(newvar)</span>
<span class="sd">                if ref in self.refs:</span>
<span class="sd">                    i = self.refs.index(ref)</span>
<span class="sd">                    refs = self.refs[:i] + [newvar] + self.refs[i + 1:]</span>
<span class="sd">                else:</span>
<span class="sd">                    refs = self.refs</span>
<span class="sd">                self = self.__class__(refs,</span>
<span class="sd">                           [cond.replace(ref, newvarex, True)</span>
<span class="sd">                            for cond in self.conds])</span>

<span class="sd">            #replace in the conditions</span>
<span class="sd">            return self.__class__(self.refs,</span>
<span class="sd">                       [cond.replace(variable, expression, replace_bound)</span>
<span class="sd">                        for cond in self.conds])&#39;&#39;&#39;</span>

<div class="viewcode-block" id="DRS.free"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DRS.free">[docs]</a>    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indvar_only</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;@see: Expression.free()&quot;&quot;&quot;</span>
        <span class="n">conds_free</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">or_</span><span class="p">,</span>
                            <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">variables</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">],</span> <span class="nb">set</span><span class="p">())</span> <span class="c1"># .free(indvar_only)</span>
        <span class="k">return</span> <span class="n">conds_free</span> <span class="o">-</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">)</span> <span class="o">|</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">or_</span><span class="p">,</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">refs</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">PresuppositionDRS</span><span class="p">)],</span> <span class="nb">set</span><span class="p">()))</span></div>

<div class="viewcode-block" id="DRS.get_refs"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DRS.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;@see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">recursive</span><span class="p">:</span>
            <span class="n">cond_refs</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span>
                               <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">],</span> <span class="p">[])</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span> <span class="o">+</span> <span class="n">cond_refs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span> <span class="o">+</span> <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">refs</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">PresuppositionDRS</span><span class="p">)],</span> <span class="p">[])</span></div>

<div class="viewcode-block" id="DRS.deepcopy"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DRS.deepcopy">[docs]</a>    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;This method returns a deep copy of the DRS.</span>
<span class="sd">        Optionally, it can take a list of lists of tuples (DRS, function)</span>
<span class="sd">        as an argument and generate a reading by performing</span>
<span class="sd">        a substitution in the DRS as specified by the function.</span>
<span class="sd">        @param operations: a list of lists of tuples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">functions</span> <span class="o">=</span> <span class="p">[</span><span class="n">function</span> <span class="k">for</span> <span class="n">drs</span><span class="p">,</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">operations</span> <span class="k">if</span> <span class="n">drs</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">]</span>
        <span class="n">newdrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">),</span> <span class="p">[</span><span class="n">cond</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operations</span><span class="p">)</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="n">functions</span><span class="p">:</span>
            <span class="n">newdrs</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">newdrs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newdrs</span></div>

<div class="viewcode-block" id="DRS.simplify"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DRS.simplify">[docs]</a>    <span class="k">def</span> <span class="nf">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="p">[</span><span class="n">cond</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">])</span></div>

<div class="viewcode-block" id="DRS.readings"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DRS.readings">[docs]</a>    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;get the readings for this DRS&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cond</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">):</span>
            <span class="n">_readings</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">_readings</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">_readings</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">reading</span> <span class="ow">in</span> <span class="n">_readings</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">reading</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="bp">self</span><span class="p">,</span> <span class="n">ConditionRemover</span><span class="p">(</span><span class="n">i</span><span class="p">)))</span>
                <span class="k">return</span> <span class="n">_readings</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syntax</span><span class="o">=</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">NLTK</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">syntax</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">PROVER9</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">syntax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;([</span><span class="si">%s</span><span class="s1">],[</span><span class="si">%s</span><span class="s1">])&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">]),</span>
                                    <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="n">syntax</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span><span class="p">]))</span></div>

<div class="viewcode-block" id="DrtVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtVariableExpression">[docs]</a><span class="k">def</span> <span class="nf">DrtVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a factory method that instantiates and returns a subtype of</span>
<span class="sd">    C{DrtAbstractVariableExpression} appropriate for the given variable.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">is_indvar</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtIndividualVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_funcvar</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtFunctionVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_eventvar</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtEventVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_statevar</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtStateVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_uttervar</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtUtterVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">is_timevar</span><span class="p">(</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtTimeVariableExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DrtConstantExpression</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span></div>


<div class="viewcode-block" id="DrtAbstractVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtAbstractVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtAbstractVariableExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtAbstractVariableExpression</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtIndividualVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtIndividualVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtIndividualVariableExpression</span><span class="p">(</span><span class="n">DrtAbstractVariableExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtIndividualVariableExpression</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtFunctionVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtFunctionVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtFunctionVariableExpression</span><span class="p">(</span><span class="n">DrtAbstractVariableExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtFunctionVariableExpression</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="DrtEventVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtEventVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtEventVariableExpression</span><span class="p">(</span><span class="n">DrtIndividualVariableExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtEventVariableExpression</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="DrtTimeVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtTimeVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtTimeVariableExpression</span><span class="p">(</span><span class="n">DrtIndividualVariableExpression</span><span class="p">,</span> <span class="n">TimeVariableExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;expression of discourse referents of time&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="DrtStateVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtStateVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtStateVariableExpression</span><span class="p">(</span><span class="n">DrtIndividualVariableExpression</span><span class="p">,</span> <span class="n">StateVariableExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;expression of discourse referents of state&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="DrtConstantExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtConstantExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtConstantExpression</span><span class="p">(</span><span class="n">DrtAbstractVariableExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtConstantExpression</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="DrtUtterVariableExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtUtterVariableExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtUtterVariableExpression</span><span class="p">(</span><span class="n">DrtTimeVariableExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;expression of utterance time referent&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="DrtFeatureExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtFeatureExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtFeatureExpression</span><span class="p">(</span><span class="n">DrtConstantExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;expression for a single syntactic feature&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="DrtFeatureConstantExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtFeatureConstantExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtFeatureConstantExpression</span><span class="p">(</span><span class="n">DrtConstantExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A constant expression with syntactic features attached&quot;&quot;&quot;</span>
<div class="viewcode-block" id="DrtFeatureConstantExpression.__init__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtFeatureConstantExpression.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
        <span class="n">DrtConstantExpression</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">features</span></div>

<div class="viewcode-block" id="DrtFeatureConstantExpression.replace"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtFeatureConstantExpression.replace">[docs]</a>    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;@see: Expression.replace()&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">Variable</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not a Variable&quot;</span> <span class="o">%</span> <span class="n">variable</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expression</span><span class="p">,</span> <span class="n">Expression</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> is not an Expression&quot;</span> <span class="o">%</span> <span class="n">expression</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">DrtConstantExpression</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">)</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="p">[</span><span class="n">feature</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">)</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">])</span></div>

<div class="viewcode-block" id="DrtFeatureConstantExpression.visit"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtFeatureConstantExpression.visit">[docs]</a>    <span class="k">def</span> <span class="nf">visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">combinator</span><span class="p">,</span> <span class="n">default</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;@see: Expression.visit()&quot;&quot;&quot;</span>
        <span class="n">re</span> <span class="o">=</span> <span class="n">combinator</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">),</span> <span class="n">reduce</span><span class="p">(</span><span class="n">combinator</span><span class="p">,</span>
                      <span class="p">[</span><span class="n">function</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">],</span> <span class="n">default</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">re</span></div>

    <span class="k">def</span> <span class="nf">str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syntax</span><span class="o">=</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">NLTK</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span> <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>

    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtConstantExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtProperNameExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtProperNameExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtProperNameExpression</span><span class="p">(</span><span class="n">DrtConstantExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;proper names&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="DrtNegatedExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtNegatedExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtNegatedExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtNegatedExpression</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operations</span><span class="p">))</span></div>

<div class="viewcode-block" id="DrtLambdaExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtLambdaExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtLambdaExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtLambdaExpression</span><span class="p">):</span>
<div class="viewcode-block" id="DrtLambdaExpression.alpha_convert"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtLambdaExpression.alpha_convert">[docs]</a>    <span class="k">def</span> <span class="nf">alpha_convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">newvar</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Rename all occurrences of the variable introduced by this variable</span>
<span class="sd">        binder in the expression to @C{newvar}.</span>
<span class="sd">        @param newvar: C{Variable}, for the new variable</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">newvar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span>
                          <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">newvar</span><span class="p">),</span> <span class="kc">True</span><span class="p">))</span></div>

    <span class="sd">&#39;&#39;&#39;def replace(self, variable, expression, replace_bound=False):</span>
<span class="sd">        &quot;&quot;&quot;@see: Expression.replace()&quot;&quot;&quot;</span>
<span class="sd">        assert isinstance(variable, Variable), &quot;%s is not a Variable&quot; % variable</span>
<span class="sd">        assert isinstance(expression, Expression), &quot;%s is not an Expression&quot; % expression</span>
<span class="sd">        #if the bound variable is the thing being replaced</span>
<span class="sd">        if self.variable == variable:</span>
<span class="sd">            if replace_bound:</span>
<span class="sd">                assert isinstance(expression, DrtAbstractVariableExpression), \</span>
<span class="sd">                       &quot;%s is not a AbstractVariableExpression&quot; % expression</span>
<span class="sd">                return self.__class__(expression.variable,</span>
<span class="sd">                                      self.term.replace(variable, expression, True))</span>
<span class="sd">            else:</span>
<span class="sd">                return self</span>
<span class="sd">        else:</span>
<span class="sd">            # if the bound variable appears in the expression, then it must</span>
<span class="sd">            # be alpha converted to avoid a conflict</span>
<span class="sd">            if self.variable in expression.free():</span>
<span class="sd">                self = self.alpha_convert(unique_variable(pattern=self.variable))</span>

<span class="sd">            #replace in the term</span>
<span class="sd">            return self.__class__(self.variable,</span>
<span class="sd">                                  self.term.replace(variable, expression, replace_bound))&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">term</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operations</span><span class="p">))</span>

<div class="viewcode-block" id="DrtLambdaExpression.get_refs"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtLambdaExpression.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;@see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[]</span></div></div>

<div class="viewcode-block" id="DrtBooleanExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtBooleanExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtBooleanExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtBooleanExpression</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="n">first_readings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">first_readings</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">first_readings</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operations</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operations</span><span class="p">))</span>

<div class="viewcode-block" id="DrtBooleanExpression.simplify"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtBooleanExpression.simplify">[docs]</a>    <span class="k">def</span> <span class="nf">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;When dealing with DRSs, it is good to have unique names for</span>
<span class="sd">        the referents bound by each DRS.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">DRS</span><span class="p">):</span>
            <span class="n">new_second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">)):</span>
                <span class="n">newref</span> <span class="o">=</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">unique_variable</span><span class="p">(</span><span class="n">ref</span><span class="p">))</span>
                <span class="n">new_second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">newref</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtBooleanExpression</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">new_second</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtBooleanExpression</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="DrtOrExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtOrExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtOrExpression</span><span class="p">(</span><span class="n">DrtBooleanExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtOrExpression</span><span class="p">):</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="DrtImpExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtImpExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtImpExpression</span><span class="p">(</span><span class="n">DrtBooleanExpression</span><span class="p">,</span> <span class="n">ImpExpression</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">first_drs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span>
        <span class="n">second_drs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span>

        <span class="n">accum</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">first_drs</span><span class="o">.</span><span class="n">conds</span><span class="p">:</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">AndExpression</span><span class="p">,</span>
                           <span class="p">[</span><span class="n">c</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">first_drs</span><span class="o">.</span><span class="n">conds</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">accum</span><span class="p">:</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="n">ImpExpression</span><span class="p">(</span><span class="n">accum</span><span class="p">,</span> <span class="n">second_drs</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="n">second_drs</span><span class="o">.</span><span class="n">fol</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">first_drs</span><span class="o">.</span><span class="n">refs</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="n">AllExpression</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">accum</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">accum</span>

    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="n">first_readings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">first_readings</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">first_readings</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">])</span>

<div class="viewcode-block" id="DrtImpExpression.__eq__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtImpExpression.__eq__">[docs]</a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">second</span><span class="p">,</span> <span class="n">DRS</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">conds</span><span class="p">):</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">refs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">refs</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">refs</span><span class="p">):</span>
                        <span class="n">varex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_VariableExpression</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
                        <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">varex</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">conds</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">conds</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">conds</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">conds</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">first</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">second</span>
        <span class="k">return</span> <span class="kc">False</span></div></div>

<span class="sd">&#39;&#39;&#39;class DrtImpExpression(DrtBooleanExpression, drt.DrtImpExpression):&#39;&#39;&#39;</span>


<div class="viewcode-block" id="DrtIffExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtIffExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtIffExpression</span><span class="p">(</span><span class="n">DrtBooleanExpression</span><span class="p">,</span> <span class="n">IffExpression</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">IffExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">fol</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span></div>



<div class="viewcode-block" id="DrtEqualityExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtEqualityExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtEqualityExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtEqualityExpression</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operations</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operations</span><span class="p">))</span></div>

<div class="viewcode-block" id="DrtConcatenation"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtConcatenation">[docs]</a><span class="k">class</span> <span class="nc">DrtConcatenation</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtConcatenation</span><span class="p">):</span>

<div class="viewcode-block" id="DrtConcatenation.__hash__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtConcatenation.__hash__">[docs]</a>    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
    
    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Try to implement deepcopy</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>

    <span class="sd">&quot;&quot;&quot;DRS of the form &#39;(DRS + DRS)&#39;&quot;&quot;&quot;</span>
<div class="viewcode-block" id="DrtConcatenation.replace"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtConcatenation.replace">[docs]</a>    <span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha_convert</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Replace all instances of variable v with expression E in self,</span>
<span class="sd">        where v is free in self.&quot;&quot;&quot;</span>
        <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span>
        <span class="n">second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span>

        <span class="c1"># If variable is bound by both first and second</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">second</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span> <span class="ow">and</span> \
           <span class="n">variable</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">second</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))):</span>
            <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># If variable is bound by first</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span> <span class="ow">and</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">first</span><span class="o">.</span><span class="n">refs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">replace_bound</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">)</span>
                <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">)</span>

        <span class="c1"># If variable is bound by second</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">second</span><span class="p">,</span> <span class="n">DRS</span><span class="p">)</span> <span class="ow">and</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">second</span><span class="o">.</span><span class="n">refs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">replace_bound</span><span class="p">:</span>
                <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">)</span>
                <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># alpha convert every ref that is free in &#39;expression&#39;</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span> <span class="o">&amp;</span> <span class="n">expression</span><span class="o">.</span><span class="n">free</span><span class="p">()):</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">unique_variable</span><span class="p">(</span><span class="n">ref</span><span class="p">))</span>
                <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

            <span class="n">first</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">)</span>
            <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">expression</span><span class="p">,</span> <span class="n">replace_bound</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span></div>

<div class="viewcode-block" id="DrtConcatenation.simplify"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtConcatenation.simplify">[docs]</a>    <span class="k">def</span> <span class="nf">simplify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">first</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        <span class="n">second</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="p">(</span><span class="n">DRS</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DRS</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">second</span><span class="p">,</span> <span class="p">(</span><span class="n">DRS</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DRS</span><span class="p">)):</span>
            <span class="c1"># For any ref that is in both &#39;first&#39; and &#39;second&#39;</span>
            <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">second</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="kc">True</span><span class="p">))):</span>
                <span class="c1"># alpha convert the ref in &#39;second&#39; to prevent collision</span>
                <span class="n">newvar</span> <span class="o">=</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">unique_variable</span><span class="p">(</span><span class="n">ref</span><span class="p">))</span>
                <span class="n">second</span> <span class="o">=</span> <span class="n">second</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="n">newvar</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

            <span class="c1">#DRS type is derived from the first member or from the second one</span>
            <span class="n">drs_type</span> <span class="o">=</span> <span class="n">first</span><span class="o">.</span><span class="vm">__class__</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">PresuppositionDRS</span><span class="p">)</span> <span class="k">else</span> <span class="n">second</span><span class="o">.</span><span class="vm">__class__</span>
            <span class="k">return</span> <span class="n">drs_type</span><span class="p">(</span><span class="n">first</span><span class="o">.</span><span class="n">refs</span> <span class="o">+</span> <span class="n">second</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">first</span><span class="o">.</span><span class="n">conds</span> <span class="o">+</span> <span class="n">second</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span></div>


<div class="viewcode-block" id="DrtConcatenation.get_refs"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtConcatenation.get_refs">[docs]</a>    <span class="k">def</span> <span class="nf">get_refs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;@see: AbstractExpression.get_refs()&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="n">recursive</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">get_refs</span><span class="p">(</span><span class="n">recursive</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">getOp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">syntax</span><span class="o">=</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">NLTK</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">DRS_CONC</span>

<div class="viewcode-block" id="DrtConcatenation.__eq__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtConcatenation.__eq__">[docs]</a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Defines equality modulo alphabetic variance.</span>
<span class="sd">        If we are comparing \x.M  and \y.N, then check equality of M and N[x/y].&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ConcatenationDRS</span><span class="p">):</span>
            <span class="n">self_refs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_refs</span><span class="p">()</span>
            <span class="n">other_refs</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_refs</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">self_refs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_refs</span><span class="p">):</span>
                <span class="n">converted_other</span> <span class="o">=</span> <span class="n">other</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">r1</span><span class="p">,</span><span class="n">r2</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">self_refs</span><span class="p">,</span> <span class="n">other_refs</span><span class="p">):</span>
                    <span class="n">varex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_VariableExpression</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
                    <span class="n">converted_other</span> <span class="o">=</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span> <span class="n">varex</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">first</span> <span class="o">==</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">first</span> <span class="ow">and</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">second</span> <span class="o">==</span> <span class="n">converted_other</span><span class="o">.</span><span class="n">second</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">AndExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">fol</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">second</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span></div>


<span class="sd">&#39;&#39;&#39;class ConcatenationDRS(DrtBooleanExpression, drt.ConcatenationDRS):&#39;&#39;&#39;</span>


<div class="viewcode-block" id="DrtApplicationExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtApplicationExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtApplicationExpression</span><span class="p">(</span><span class="n">DrtExpression</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtApplicationExpression</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">fol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_propername</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">EqualityExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">fol</span><span class="p">(),</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span>

        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">ApplicationExpression</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">fol</span><span class="p">(),</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">fol</span><span class="p">())</span>

<div class="viewcode-block" id="DrtApplicationExpression.is_propername"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtApplicationExpression.is_propername">[docs]</a>    <span class="k">def</span> <span class="nf">is_propername</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A proper name is capitalised. We assume that John(x) uniquely</span>
<span class="sd">        identifies the bearer of the name John and so, when going from Kamp &amp; Reyle&#39;s</span>
<span class="sd">        DRT format into classical FOL logic, we change a condition like that into John = x.</span>

<span class="sd">        @return: C{boolean} True if expr is of the correct form</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtConstantExpression</span><span class="p">)</span> <span class="ow">and</span>\
        <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">istitle</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="n">function_readings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">function_readings</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">function_readings</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="n">trail</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="p">[]):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operations</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">operations</span><span class="p">))</span></div>

<div class="viewcode-block" id="DrtEventualityApplicationExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtEventualityApplicationExpression">[docs]</a><span class="k">class</span> <span class="nc">DrtEventualityApplicationExpression</span><span class="p">(</span><span class="n">DrtApplicationExpression</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;application expression with state or event argument&quot;&quot;&quot;</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="PresuppositionDRS"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS">[docs]</a><span class="k">class</span> <span class="nc">PresuppositionDRS</span><span class="p">(</span><span class="n">DRS</span><span class="p">):</span>

<div class="viewcode-block" id="PresuppositionDRS.readings"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.readings">[docs]</a>    <span class="k">def</span> <span class="nf">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="n">inner_readings</span> <span class="o">=</span> <span class="n">DRS</span><span class="o">.</span><span class="n">readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inner_readings</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inner_readings</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_presupp_data</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_presupposition_readings</span><span class="p">(</span><span class="n">trail</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_find_outer_drs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">trail</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">DRS</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">expr</span>

    <span class="k">def</span> <span class="nf">_find_local_drs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="p">):</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">trail</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">drs</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expr</span><span class="p">,</span> <span class="n">DrtNegatedExpression</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">drs</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">drs</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">expr</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">DRS</span><span class="p">:</span>
                <span class="n">drs</span> <span class="o">=</span> <span class="n">expr</span>
        <span class="k">return</span> <span class="n">drs</span>

    <span class="k">def</span> <span class="nf">is_possible_binding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">is_unary_predicate</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_same_features</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">DrtIndividualVariableExpression</span>

    <span class="k">def</span> <span class="nf">find_bindings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="p">,</span> <span class="n">collect_event_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="n">DRS</span><span class="p">,</span> <span class="n">individuals</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">bindings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">collect_event_data</span><span class="p">:</span>
            <span class="n">event_data_map</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">event_strings_map</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">is_bindable</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># do not allow forward binding</span>
        <span class="k">for</span> <span class="n">drs</span> <span class="ow">in</span> <span class="p">(</span><span class="n">expr</span> <span class="k">for</span> <span class="n">expr</span> <span class="ow">in</span> <span class="n">trail</span> <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">expr</span><span class="p">))):</span>
            <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">:</span>
                <span class="c1"># Ignore conditions following the presupposition DRS</span>
                <span class="k">if</span> <span class="n">cond</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">collect_event_data</span><span class="p">:</span>
                        <span class="k">break</span> <span class="c1"># assuming that the filtered_trail has drss ordered from the outermost to the innermost</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">DrtApplicationExpression</span><span class="p">):</span>
                    <span class="k">continue</span>
                    <span class="n">is_bindable</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">is_bindable</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_possible_binding</span><span class="p">(</span><span class="n">cond</span><span class="p">):</span>
                    <span class="n">bindings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">collect_event_data</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">collect_event_data</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">event_data_map</span><span class="p">,</span> <span class="n">event_strings_map</span><span class="p">,</span> <span class="n">individuals</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">collect_event_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_enrich_event_data_map</span><span class="p">(</span><span class="n">event_data_map</span><span class="p">,</span> <span class="n">event_strings_map</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">bindings</span><span class="p">,</span> <span class="n">event_data_map</span><span class="p">)</span> <span class="k">if</span> <span class="n">collect_event_data</span> <span class="k">else</span> <span class="n">bindings</span>

    <span class="k">def</span> <span class="nf">collect_event_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">event_data_map</span><span class="p">,</span> <span class="n">event_strings_map</span><span class="p">,</span> <span class="n">individuals</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtApplicationExpression</span><span class="p">)</span> <span class="ow">and</span> \
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="n">DrtIndividualVariableExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="n">DrtTimeVariableExpression</span><span class="p">):</span>
                <span class="n">event_data_map</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">cond</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">DrtEventualityApplicationExpression</span> <span class="ow">and</span> \
        <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="n">DrtEventVariableExpression</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="n">DrtStateVariableExpression</span><span class="p">))</span> <span class="ow">and</span>\
        <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtApplicationExpression</span><span class="p">):</span>
            <span class="k">assert</span> <span class="n">cond</span><span class="o">.</span><span class="n">argument</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">event_strings_map</span>
            <span class="n">event_strings_map</span><span class="p">[</span><span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="p">]</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span>
        <span class="c1"># The rest are nouns and attributive adjectives</span>
        <span class="k">elif</span> <span class="n">individuals</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">DrtApplicationExpression</span> <span class="ow">and</span> \
        <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtApplicationExpression</span><span class="p">):</span>
            <span class="n">individuals</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_enrich_event_data_map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_data_map</span><span class="p">,</span> <span class="n">event_strings_map</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">event_data_map</span><span class="p">:</span>
            <span class="n">new_event_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">event_tuple</span> <span class="ow">in</span> <span class="n">event_data_map</span><span class="p">[</span><span class="n">individual</span><span class="p">]:</span>
                <span class="n">new_event_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">event_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">event_tuple</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">event_strings_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">)))</span>
            <span class="n">event_data_map</span><span class="p">[</span><span class="n">individual</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_event_list</span>

    <span class="k">def</span> <span class="nf">is_presupposition_cond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_init_presupp_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">presupp_cond_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">cond</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span> <span class="k">if</span> <span class="n">is_unary_predicate</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">variable</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_presupposition_cond</span><span class="p">(</span><span class="n">cond</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">presupp_cond_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtFeatureConstantExpression</span><span class="p">):</span> <span class="c1"># this is the one</span>
                <span class="c1"># There can be more than one DrtFeatureConstantExpression on the conditions on list, e.g.</span>
                <span class="c1"># &quot;Tom, a kind boy, took her hand&quot;, or &quot;Tom, who is a kind boy,...&quot;, or &quot;Linguist Grimm suggested ...&quot;,</span>
                <span class="c1"># or &quot;The distinguished physicist Einstein ...&quot;. But &#39;is_presupposition_cond&#39; helps us find the right one.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">variable</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">features</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cond</span> <span class="o">=</span> <span class="n">cond</span>
                <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span> <span class="o">=</span> <span class="n">presupp_cond_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cond</span> <span class="o">=</span> <span class="n">presupp_cond_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">has_same_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtFeatureConstantExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">DrtFeatureConstantExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">features</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">features</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_condition_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">superordinate_drs</span><span class="p">,</span> <span class="n">trail</span><span class="p">,</span> <span class="n">condition_index_cache</span><span class="o">=</span><span class="p">{}):</span>
        <span class="c1"># Keep a condition index cache</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">condition_index_cache</span><span class="p">:</span>
            <span class="n">condition_index_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">superordinate_drs_index</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">superordinate_drs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">superordinate_drs_index</span> <span class="ow">in</span> <span class="n">condition_index_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">condition_index_cache</span><span class="p">[</span><span class="n">superordinate_drs_index</span><span class="p">]</span>
        <span class="c1"># Use a for loop and &#39;is&#39; to find the condition.</span>
        <span class="c1"># Do not use index(), because it calls a time-consuming equals method.</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">trailee</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trail</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">trailee</span> <span class="ow">is</span> <span class="n">superordinate_drs</span><span class="p">:</span>
                <span class="c1"># The condition might be not in superordinate_drs, but inside one of its conditions (however deep we might need to go)</span>
                <span class="n">look_for</span> <span class="o">=</span> <span class="n">trail</span><span class="p">[</span><span class="n">ind</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">ind</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">trail</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">self</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cond</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">superordinate_drs</span><span class="o">.</span><span class="n">conds</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">cond</span> <span class="ow">is</span> <span class="n">look_for</span><span class="p">:</span>
                        <span class="n">condition_index_cache</span><span class="p">[</span><span class="n">superordinate_drs_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                        <span class="k">return</span> <span class="n">i</span> <span class="c1"># condition_index</span>
        <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="PresuppositionDRS.Operation"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.Operation">[docs]</a>    <span class="k">class</span> <span class="nc">Operation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;An interface for all operations&quot;&quot;&quot;</span>
<div class="viewcode-block" id="PresuppositionDRS.Operation.__call__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.Operation.__call__">[docs]</a>        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>

<div class="viewcode-block" id="PresuppositionDRS.Accommodate"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.Accommodate">[docs]</a>    <span class="k">class</span> <span class="nc">Accommodate</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
<div class="viewcode-block" id="PresuppositionDRS.Accommodate.__init__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.Accommodate.__init__">[docs]</a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">presupp_drs</span><span class="p">,</span> <span class="n">condition_index</span><span class="p">):</span>
            <span class="c1"># We need the condition index so that the conditions are not just appended to the list of conditions of the DRS,</span>
            <span class="c1"># but inserted where the presuppositional DRS had been. The order of conditions is important, because it reflects</span>
            <span class="c1"># the proximity of a possible antecedent, which affects antecedent ranking (and our architecture does not allow us to use the</span>
            <span class="c1"># index on the list of referents to reflect the proximity/thematic role).</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">presupp_drs</span> <span class="o">=</span> <span class="n">presupp_drs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition_index</span> <span class="o">=</span> <span class="n">condition_index</span></div>
<div class="viewcode-block" id="PresuppositionDRS.Accommodate.__call__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.Accommodate.__call__">[docs]</a>        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Accommodation: put all referents and conditions from</span>
<span class="sd">            the presupposition DRS into the given DRS&quot;&quot;&quot;</span>
            <span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presupp_drs</span><span class="o">.</span><span class="n">refs</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presupp_drs</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">drs</span><span class="o">.</span><span class="n">conds</span> <span class="o">=</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">condition_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">presupp_drs</span><span class="o">.</span><span class="n">conds</span> <span class="o">+</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">condition_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
            <span class="k">return</span> <span class="n">drs</span></div></div>

<div class="viewcode-block" id="PresuppositionDRS.Bind"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.Bind">[docs]</a>    <span class="k">class</span> <span class="nc">Bind</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
<div class="viewcode-block" id="PresuppositionDRS.Bind.__init__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.Bind.__init__">[docs]</a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">presupp_drs</span><span class="p">,</span> <span class="n">presupp_variable</span><span class="p">,</span> <span class="n">presupp_funcname</span><span class="p">,</span> <span class="n">antecedent_cond</span><span class="p">,</span> <span class="n">condition_index</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">presupp_drs</span> <span class="o">=</span> <span class="n">presupp_drs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">presupp_variable</span> <span class="o">=</span> <span class="n">presupp_variable</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">presupp_funcname</span> <span class="o">=</span> <span class="n">presupp_funcname</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">antecedent_cond</span> <span class="o">=</span> <span class="n">antecedent_cond</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">condition_index</span> <span class="o">=</span> <span class="n">condition_index</span></div>
<div class="viewcode-block" id="PresuppositionDRS.Bind.__call__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.Bind.__call__">[docs]</a>        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Put all conditions from the presuppositional DRS into the DRS (but do not create duplicates),</span>
<span class="sd">            and replace the presupposition condition referent in them with antecedent referent&quot;&quot;&quot;</span>
            <span class="n">newdrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">presupp_drs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presupp_variable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">antecedent_cond</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="c1"># There will be referents and conditions to move</span>
            <span class="c1"># if there is a relative clause modifying the noun that has triggered the presuppositon</span>
            <span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">ref</span> <span class="k">for</span> <span class="n">ref</span> <span class="ow">in</span> <span class="n">newdrs</span><span class="o">.</span><span class="n">refs</span> \
                             <span class="k">if</span> <span class="n">ref</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">antecedent_cond</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">variable</span><span class="p">])</span>
            <span class="n">conds_to_move</span> <span class="o">=</span> <span class="p">[</span><span class="n">cond</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">newdrs</span><span class="o">.</span><span class="n">conds</span> \
                             <span class="k">if</span> <span class="ow">not</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">]</span>
            <span class="c1"># Put the conditions at the position of the original presupposition DRS</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">condition_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># it is an index, it can be zero</span>
                <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">conds_to_move</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">drs</span><span class="o">.</span><span class="n">conds</span> <span class="o">=</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">condition_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">conds_to_move</span> <span class="o">+</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">condition_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span>
            <span class="k">return</span> <span class="n">drs</span></div></div>

<div class="viewcode-block" id="PresuppositionDRS.InnerReplace"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.InnerReplace">[docs]</a>    <span class="k">class</span> <span class="nc">InnerReplace</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
<div class="viewcode-block" id="PresuppositionDRS.InnerReplace.__init__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.InnerReplace.__init__">[docs]</a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">presupp_variable</span><span class="p">,</span> <span class="n">antecedent_ref</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">presupp_variable</span> <span class="o">=</span> <span class="n">presupp_variable</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">antecedent_ref</span> <span class="o">=</span> <span class="n">antecedent_ref</span></div>
<div class="viewcode-block" id="PresuppositionDRS.InnerReplace.__call__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.InnerReplace.__call__">[docs]</a>        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;In the conditions of the local DRS, replace the</span>
<span class="sd">                referent of the presupposition condition with antecedent_ref&quot;&quot;&quot;</span>
                <span class="k">return</span> <span class="n">drs</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">presupp_variable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">antecedent_ref</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="PresuppositionDRS.MoveTemporalConditions"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.MoveTemporalConditions">[docs]</a>    <span class="k">class</span> <span class="nc">MoveTemporalConditions</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
<div class="viewcode-block" id="PresuppositionDRS.MoveTemporalConditions.__init__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.MoveTemporalConditions.__init__">[docs]</a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temporal_conditions</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temporal_conditions</span> <span class="o">=</span> <span class="n">temporal_conditions</span></div>
<div class="viewcode-block" id="PresuppositionDRS.MoveTemporalConditions.__call__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.MoveTemporalConditions.__call__">[docs]</a>        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">):</span>
                <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temporal_conditions</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">drs</span></div></div>

<div class="viewcode-block" id="PresuppositionDRS.DoMultipleOperations"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.DoMultipleOperations">[docs]</a>    <span class="k">class</span> <span class="nc">DoMultipleOperations</span><span class="p">(</span><span class="n">Operation</span><span class="p">):</span>
<div class="viewcode-block" id="PresuppositionDRS.DoMultipleOperations.__init__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.DoMultipleOperations.__init__">[docs]</a>        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operations_list</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">operations_list</span> <span class="o">=</span> <span class="n">operations_list</span></div>

<div class="viewcode-block" id="PresuppositionDRS.DoMultipleOperations.__call__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PresuppositionDRS.DoMultipleOperations.__call__">[docs]</a>        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;Do the operations one by one&quot;&quot;&quot;</span>
            <span class="k">for</span> <span class="n">operation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">operations_list</span><span class="p">:</span>
                <span class="n">drs</span> <span class="o">=</span> <span class="n">operation</span><span class="p">(</span><span class="n">drs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">drs</span></div></div>

    <span class="k">def</span> <span class="nf">binding_reading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_drs</span><span class="p">,</span> <span class="n">target_drs</span><span class="p">,</span> <span class="n">antecedent_cond</span><span class="p">,</span> <span class="n">trail</span><span class="p">,</span> <span class="n">temporal_conditions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">local_drs</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">condition_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_condition_index</span><span class="p">(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">trail</span><span class="p">)</span>
        <span class="n">binder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span><span class="p">,</span> <span class="n">antecedent_cond</span><span class="p">,</span> <span class="n">condition_index</span><span class="p">)</span>
        <span class="n">inner_replacer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">InnerReplace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">antecedent_cond</span><span class="o">.</span><span class="n">argument</span><span class="p">)</span>
        <span class="n">temp_cond_mover</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MoveTemporalConditions</span><span class="p">(</span><span class="n">temporal_conditions</span><span class="p">)</span> <span class="k">if</span> <span class="n">temporal_conditions</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">inner_drs</span> <span class="ow">is</span> <span class="n">target_drs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">temp_cond_mover</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">local_drs</span> <span class="ow">is</span> <span class="n">target_drs</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Binding</span><span class="p">([(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">binder</span><span class="p">),</span> <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">temp_cond_mover</span><span class="p">),</span> <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">inner_replacer</span><span class="p">)])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Binding</span><span class="p">([(</span><span class="n">local_drs</span><span class="p">,</span> <span class="n">temp_cond_mover</span><span class="p">),</span>
                                    <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">binder</span><span class="p">),</span> <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">inner_replacer</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Binding</span><span class="p">([(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">binder</span><span class="p">),</span> <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">inner_replacer</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">temp_cond_mover</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">local_drs</span> <span class="ow">is</span> <span class="n">target_drs</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Binding</span><span class="p">([(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">binder</span><span class="p">),</span> <span class="p">(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">temp_cond_mover</span><span class="p">),</span>
                                    <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">inner_replacer</span><span class="p">)])</span>
                <span class="k">elif</span> <span class="n">local_drs</span> <span class="ow">is</span> <span class="n">inner_drs</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Binding</span><span class="p">([(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">binder</span><span class="p">),</span>
                                    <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">temp_cond_mover</span><span class="p">),</span> <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">inner_replacer</span><span class="p">)])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">Binding</span><span class="p">([(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">binder</span><span class="p">),</span>
                                    <span class="p">(</span><span class="n">local_drs</span><span class="p">,</span> <span class="n">temp_cond_mover</span><span class="p">),</span>
                                    <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">inner_replacer</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Binding</span><span class="p">([(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">binder</span><span class="p">),</span>
                        <span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">inner_replacer</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">accommodation_reading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_drs</span><span class="p">,</span> <span class="n">trail</span><span class="p">,</span> <span class="n">temporal_conditions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">local_drs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reading_type</span><span class="o">=</span><span class="n">Binding</span><span class="p">):</span>
        <span class="n">condition_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_condition_index</span><span class="p">(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">trail</span><span class="p">)</span>
        <span class="n">accommodator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Accommodate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">condition_index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">temporal_conditions</span><span class="p">:</span>
            <span class="n">temp_cond_mover</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">MoveTemporalConditions</span><span class="p">(</span><span class="n">temporal_conditions</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">local_drs</span> <span class="ow">is</span> <span class="n">target_drs</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">reading_type</span><span class="p">([(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">temp_cond_mover</span><span class="p">),</span> <span class="p">(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">accommodator</span><span class="p">)])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">reading_type</span><span class="p">([(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">accommodator</span><span class="p">),</span>
                                <span class="p">(</span><span class="n">local_drs</span><span class="p">,</span> <span class="n">temp_cond_mover</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">reading_type</span><span class="p">([(</span><span class="n">target_drs</span><span class="p">,</span> <span class="n">accommodator</span><span class="p">)])</span></div>

<div class="viewcode-block" id="PronounDRS"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.PronounDRS">[docs]</a><span class="k">class</span> <span class="nc">PronounDRS</span><span class="p">(</span><span class="n">PresuppositionDRS</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for DRSs for personal, reflexive, and possessive pronouns</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PRONOUNS</span> <span class="o">=</span> <span class="p">[</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">PRONOUN</span><span class="p">,</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">REFLEXIVE_PRONOUN</span><span class="p">,</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">POSSESSIVE_PRONOUN</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">is_presupposition_cond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">PronounDRS</span><span class="o">.</span><span class="n">PRONOUNS</span>

    <span class="k">def</span> <span class="nf">_presupposition_readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="c1">#trail[0].draw()</span>
        <span class="n">possible_bindings</span><span class="p">,</span> <span class="n">event_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_bindings</span><span class="p">(</span><span class="n">trail</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">DRS</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">PresuppositionDRS</span><span class="p">))</span>
        <span class="n">bindings</span> <span class="o">=</span> <span class="p">[</span><span class="n">cond</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">possible_bindings</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_binding</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pro_events</span><span class="p">(</span><span class="n">event_data</span><span class="p">),</span> <span class="n">event_data</span><span class="p">)]</span>
        <span class="n">ranked_bindings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rank_bindings</span><span class="p">(</span><span class="n">bindings</span><span class="p">,</span> <span class="n">event_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">Binding</span><span class="p">([(</span><span class="n">trail</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">VariableReplacer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="p">,</span> <span class="kc">False</span><span class="p">))])</span> <span class="k">for</span> <span class="n">cond</span><span class="p">,</span> <span class="n">rank</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ranked_bindings</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)],</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_get_pro_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_data</span><span class="p">):</span>
        <span class="c1">#in case pronoun participates in only one eventuality, which has no other participants,</span>
        <span class="c1">#try to extend it with interlinked eventualities</span>
        <span class="c1">#f.e. THEME(z5,z3), THEME(e,z5) where z3 only participates in eventuality z5</span>
        <span class="c1">#will be extended to participate in e, but only in case z5 has one participant</span>
        <span class="n">pro_events</span> <span class="o">=</span> <span class="p">[</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">event_string</span> <span class="ow">in</span> <span class="n">event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="p">())]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pro_events</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">pro_event</span> <span class="o">=</span> <span class="n">pro_events</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#number of participants in the pro_event</span>
            <span class="n">participant_count</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="mi">1</span> <span class="k">for</span> <span class="n">event_list</span> <span class="ow">in</span> <span class="n">event_data</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">event_string</span> <span class="ow">in</span> <span class="n">event_list</span> <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="n">pro_event</span><span class="p">))</span>
            <span class="c1"># if there is only one participant in the pro_event and pro_event itself participates in other eventualities</span>
            <span class="k">if</span> <span class="n">participant_count</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">pro_event</span><span class="o">.</span><span class="n">variable</span> <span class="ow">in</span> <span class="n">event_data</span><span class="p">:</span>
                <span class="n">pro_events</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">event_string</span> <span class="ow">in</span> <span class="n">event_data</span><span class="p">[</span><span class="n">pro_event</span><span class="o">.</span><span class="n">variable</span><span class="p">]))</span>

        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">pro_events</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_rank_bindings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bindings</span><span class="p">,</span> <span class="n">event_data</span><span class="p">):</span>
        <span class="c1">#ranking system</span>
        <span class="c1">#increment ranking for matching roles and map the positions of antecedents</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bindings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AnaphoraResolutionException</span><span class="p">(</span><span class="s2">&quot;Variable &#39;</span><span class="si">%s</span><span class="s2">&#39; does not &quot;</span>
                                <span class="s2">&quot;resolve to anything.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">bindings</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">bindings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">bindings</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pro_roles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">role</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">event_string</span> <span class="ow">in</span> <span class="n">event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="p">())))</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">variable</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bindings</span><span class="p">):</span>
                <span class="n">var_roles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">role</span> <span class="k">for</span> <span class="n">event_list</span> <span class="ow">in</span> <span class="n">event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="p">())</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">event_string</span> <span class="ow">in</span> <span class="n">event_list</span><span class="p">))</span>
                <span class="n">bindings</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_roles</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">pro_roles</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">bindings</span>

    <span class="k">def</span> <span class="nf">_is_binding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">pro_events</span><span class="p">,</span> <span class="n">event_data</span><span class="p">):</span>
        <span class="c1">#non reflexive pronouns can not resolve to variables having a role in the same eventuality</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">POSSESSIVE_PRONOUN</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">variable</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">variable</span>
            <span class="n">variable_events</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">event_string</span> <span class="ow">in</span> <span class="n">event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="p">())))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">PRONOUN</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">variable_events</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">pro_events</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">REFLEXIVE_PRONOUN</span><span class="p">:</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="n">variable_events</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">pro_events</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="ProperNameDRS"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.ProperNameDRS">[docs]</a><span class="k">class</span> <span class="nc">ProperNameDRS</span><span class="p">(</span><span class="n">PresuppositionDRS</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_presupposition_readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot;A proper name always has one reading: it is either global binding</span>
<span class="sd">        or global accommodation (if binding is not possible)&quot;&quot;&quot;</span>
        <span class="n">outer_drs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_outer_drs</span><span class="p">(</span><span class="n">trail</span><span class="p">)</span>
        <span class="n">inner_drs</span> <span class="o">=</span> <span class="n">trail</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">possible_bindings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_bindings</span><span class="p">([</span><span class="n">outer_drs</span><span class="p">])</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">possible_bindings</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">possible_bindings</span><span class="p">:</span>
            <span class="c1"># Return the reading</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">binding_reading</span><span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">outer_drs</span><span class="p">,</span> <span class="n">possible_bindings</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">trail</span><span class="p">)],</span> <span class="kc">True</span>
        <span class="c1"># If no suitable antecedent has been found in the outer DRS,</span>
        <span class="c1"># binding is not possible, so we go for accommodation instead.</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">accommodation_reading</span><span class="p">(</span><span class="n">outer_drs</span><span class="p">,</span> <span class="n">trail</span><span class="p">)],</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">is_possible_binding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ProperNameDRS</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">is_possible_binding</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="n">is_propername</span><span class="p">()</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span>

    <span class="k">def</span> <span class="nf">is_presupposition_cond</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cond</span><span class="o">.</span><span class="n">is_propername</span><span class="p">()</span></div>

<div class="viewcode-block" id="DefiniteDescriptionDRS"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DefiniteDescriptionDRS">[docs]</a><span class="k">class</span> <span class="nc">DefiniteDescriptionDRS</span><span class="p">(</span><span class="n">PresuppositionDRS</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">_presupposition_readings</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trail</span><span class="o">=</span><span class="p">[],</span> <span class="n">overgenerate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">generate_intermediate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1"># If there is a restrictive clause or an adjunct PP, find the perfect binding or accommodate the presupposition</span>
        <span class="n">presupp_event_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">presupp_event_strings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">presupp_individuals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Are there any states/events in this presuppositional DRS that the presupposition referent takes part in?</span>
        <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="p">(</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">DrtApplicationExpression</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collect_event_data</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">presupp_event_data</span><span class="p">,</span> <span class="n">presupp_event_strings</span><span class="p">,</span> <span class="n">presupp_individuals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_enrich_event_data_map</span><span class="p">(</span><span class="n">presupp_event_data</span><span class="p">,</span> <span class="n">presupp_event_strings</span><span class="p">)</span>

        <span class="n">possible_bindings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">event_data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">individuals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">accommod_indices</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">intermediate_next</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># find the closest antecedent DRS</span>
        <span class="n">outer_drs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_outer_drs</span><span class="p">(</span><span class="n">trail</span><span class="p">)</span>
        <span class="n">local_drs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_local_drs</span><span class="p">(</span><span class="n">trail</span><span class="p">)</span>
        <span class="n">all_refs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">free</span><span class="p">,</span> <span class="n">temporal_conditions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_free</span><span class="p">()</span>
        <span class="c1"># Go through the filtered trail, find bindings and find the intermediate DRS for possible accommodation</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">drs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trail</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">drs</span><span class="p">,</span> <span class="n">DrtImpExpression</span><span class="p">):</span> <span class="n">intermediate_next</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">drs</span><span class="o">.</span><span class="vm">__class__</span> <span class="ow">is</span> <span class="n">DRS</span><span class="p">:</span> <span class="k">continue</span>
            <span class="c1"># Free variable check</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_free_variable_check</span><span class="p">(</span><span class="n">drs</span><span class="p">,</span> <span class="n">free</span><span class="p">,</span> <span class="n">all_refs</span><span class="p">):</span>
                <span class="n">intermediate_next</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">continue</span>
            <span class="c1"># Find the (maximum) three DRSs</span>
            <span class="k">if</span> <span class="n">drs</span> <span class="ow">is</span> <span class="n">outer_drs</span> <span class="ow">or</span> <span class="n">drs</span> <span class="ow">is</span> <span class="n">local_drs</span> <span class="ow">or</span> <span class="n">intermediate_next</span><span class="p">:</span>
                <span class="n">accommod_indices</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                <span class="n">intermediate_next</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># Find the bindings</span>
            <span class="n">drs_possible_bindings</span><span class="p">,</span> <span class="n">drs_event_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_bindings</span><span class="p">([</span><span class="n">drs</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="n">individuals</span><span class="o">=</span><span class="n">individuals</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">drs_event_data</span><span class="p">:</span> <span class="n">event_data</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="p">[])</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">drs_event_data</span><span class="p">[</span><span class="n">var</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">drs_possible_bindings</span><span class="p">:</span>
                <span class="n">possible_bindings</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">drs_possible_bindings</span>

        <span class="c1"># Make accommodation indices a sorted list</span>
        <span class="n">accommod_indices</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">accommod_indices</span><span class="p">))</span>
        <span class="k">def</span> <span class="nf">accommodation_cite</span><span class="p">(</span><span class="n">drsindex</span><span class="p">):</span><span class="c1">#LocalAccommodation, IntermediateAccommodation, GlobalAccommodation</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">drsindex</span> <span class="ow">in</span> <span class="n">accommod_indices</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">accommod_indices</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">drsindex</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">LocalAccommodation</span><span class="p">,</span> <span class="n">GlobalAccommodation</span><span class="p">,</span> <span class="n">GlobalAccommodation</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">accommod_indices</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">ind</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">LocalAccommodation</span><span class="p">,</span> <span class="n">IntermediateAccommodation</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">accommod_indices</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">ind</span> <span class="o">==</span> <span class="mi">2</span>
                <span class="k">return</span> <span class="n">LocalAccommodation</span>

        <span class="c1"># Filter the bindings, create the readings</span>
        <span class="n">antecedent_tracker</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># do not bind to the same referent twice</span>
        <span class="n">readings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">inner_drs</span> <span class="o">=</span> <span class="n">trail</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">drsindex</span><span class="p">,</span> <span class="n">drs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trail</span><span class="p">):</span>
            <span class="n">drs_readings</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">drsindex</span> <span class="ow">in</span> <span class="n">possible_bindings</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">possible_bindings</span><span class="p">[</span><span class="n">drsindex</span><span class="p">]):</span>
                    <span class="n">variable</span> <span class="o">=</span> <span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="o">.</span><span class="n">variable</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_binding</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">individuals</span><span class="p">[</span><span class="n">variable</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_defdescr_events</span><span class="p">(</span><span class="n">event_data</span><span class="p">),</span> <span class="n">event_data</span><span class="p">,</span> <span class="n">presupp_event_data</span><span class="p">,</span> <span class="n">presupp_individuals</span><span class="p">)</span> <span class="ow">and</span> \
                    <span class="ow">not</span> <span class="n">cond</span><span class="o">.</span><span class="n">argument</span> <span class="ow">in</span> <span class="n">antecedent_tracker</span><span class="p">:</span>
                        <span class="n">antecedent_tracker</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">argument</span><span class="p">)</span>
                        <span class="n">drs_readings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">binding_reading</span><span class="p">(</span><span class="n">inner_drs</span><span class="p">,</span> <span class="n">drs</span><span class="p">,</span> \
                                                                         <span class="n">cond</span><span class="p">,</span> <span class="n">trail</span><span class="p">,</span> <span class="n">temporal_conditions</span><span class="p">,</span> <span class="n">local_drs</span><span class="p">))</span>
            <span class="c1"># If binding is possible, no accommodation at this level or below will take place</span>
            <span class="c1"># (unless we set the &#39;overgenerate&#39; parameter to True)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">overgenerate</span> <span class="ow">and</span> <span class="n">drs_readings</span><span class="p">:</span> <span class="n">accommod_indices</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">acc_cite</span> <span class="o">=</span> <span class="n">accommodation_cite</span><span class="p">(</span><span class="n">drsindex</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">acc_cite</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">generate_intermediate</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">acc_cite</span> <span class="ow">is</span> <span class="n">IntermediateAccommodation</span><span class="p">):</span>
                    <span class="n">drs_readings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accommodation_reading</span><span class="p">(</span><span class="n">drs</span><span class="p">,</span> <span class="n">trail</span><span class="p">,</span> <span class="n">temporal_conditions</span><span class="p">,</span> <span class="n">local_drs</span><span class="p">,</span> <span class="n">acc_cite</span><span class="p">))</span>
                    <span class="n">accommod_indices</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">drsindex</span><span class="p">)</span>
            <span class="n">readings</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">drs_readings</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">readings</span><span class="p">,</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_get_free</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">free</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">free</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">free</span><span class="p">,</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">_get_defdescr_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event_data</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="p">())]</span>

    <span class="k">def</span> <span class="nf">_is_binding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span> <span class="n">var_individuals</span><span class="p">,</span> <span class="n">defdescr_events</span><span class="p">,</span> <span class="n">event_data</span><span class="p">,</span> <span class="n">presupp_event_data</span><span class="p">,</span> <span class="n">presupp_individuals</span><span class="p">):</span>
        <span class="c1"># No binding is possible to variables having a role in the same eventuality (look for eventualities in DRSs other than self)</span>
        <span class="n">variable_events</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">event_string</span> <span class="ow">in</span> <span class="n">event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="p">())))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">variable_events</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">defdescr_events</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># Don&#39;t allow binding if the potential antecedent participates in the same eventuality (in the relative clause) as self.variable, e.g.:</span>
        <span class="c1"># If John has a child, the child that likes him (him = the child in the antecedent of the impl. cond) is away.</span>
        <span class="n">variable_presupp_events</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">event_string</span> <span class="ow">in</span> <span class="n">presupp_event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="p">())))</span>
        <span class="n">defdescr_presupp_events</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">event</span> <span class="k">for</span> <span class="n">event</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">event_string</span> <span class="ow">in</span> <span class="n">presupp_event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="p">())))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">variable_presupp_events</span><span class="o">.</span><span class="n">isdisjoint</span><span class="p">(</span><span class="n">defdescr_presupp_events</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Don&#39;t allow binding x to y if there are conditions like POSS(x,y), POSS(y,x), REL(x,y), REL(y,x) and suchlike</span>
        <span class="k">for</span> <span class="n">event_tuple</span> <span class="ow">in</span> <span class="n">presupp_event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">event_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">DrtIndividualVariableExpression</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">variable</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">event_tuple</span> <span class="ow">in</span> <span class="n">presupp_event_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">event_tuple</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">==</span> <span class="n">DrtIndividualVariableExpression</span> <span class="ow">and</span> <span class="n">event</span><span class="o">.</span><span class="n">variable</span> <span class="o">==</span> <span class="n">variable</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># Perform the semantic check</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">semantic_check</span><span class="p">(</span><span class="n">var_individuals</span><span class="p">,</span> <span class="n">presupp_individuals</span><span class="p">)</span>

<div class="viewcode-block" id="DefiniteDescriptionDRS.semantic_check"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DefiniteDescriptionDRS.semantic_check">[docs]</a>    <span class="k">def</span> <span class="nf">semantic_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">individuals</span><span class="p">,</span> <span class="n">presupp_individuals</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Users can plug in their more sophisticated semantic checks here.</span>
<span class="sd">        As for this project, we confine ourselves to ontologies provided by WordNet.</span>
<span class="sd">        See the other file for how this is supposed to work.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">strict</span><span class="p">:</span>
            <span class="c1"># ------------------------ Plug in ontologies here</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cond</span><span class="p">,</span> <span class="n">DrtFeatureConstantExpression</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individuals</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">individual</span><span class="p">,</span> <span class="n">DrtFeatureConstantExpression</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">function_name</span> <span class="o">==</span> <span class="n">individual</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">True</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># If no features are used, we cannot guarantee that the condition we got self.function_name from wasn&#39;t an adjective</span>
                <span class="k">for</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">individuals</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">presupp_individual</span> <span class="ow">in</span> <span class="n">presupp_individuals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">]:</span>
                        <span class="k">if</span> <span class="n">presupp_individual</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">individual</span><span class="o">.</span><span class="n">function</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                            <span class="k">return</span> <span class="kc">True</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>

    <span class="k">def</span> <span class="nf">_free_variable_check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">,</span> <span class="n">free</span><span class="p">,</span> <span class="n">all_refs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">free</span><span class="p">:</span>
            <span class="n">all_refs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">free</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">all_refs</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="DrtParser"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtParser">[docs]</a><span class="k">class</span> <span class="nc">DrtParser</span><span class="p">(</span><span class="n">drt</span><span class="o">.</span><span class="n">DrtParser</span><span class="p">):</span>

<div class="viewcode-block" id="DrtParser.get_all_symbols"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtParser.get_all_symbols">[docs]</a>    <span class="k">def</span> <span class="nf">get_all_symbols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">SYMBOLS</span></div>

    <span class="k">def</span> <span class="nf">isvariable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">tok</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">TOKENS</span>

<div class="viewcode-block" id="DrtParser.handle"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtParser.handle">[docs]</a>    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;We add new types of DRS to represent presuppositions&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">tok</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">PRESUPPOSITION_DRS</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_PresuppositionDRS</span><span class="p">(</span><span class="n">tok</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtParser</span><span class="o">.</span><span class="n">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span></div>


<div class="viewcode-block" id="DrtParser.handle_PresuppositionDRS"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtParser.handle_PresuppositionDRS">[docs]</a>    <span class="k">def</span> <span class="nf">handle_PresuppositionDRS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parse all the Presuppositon DRSs.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertNextToken</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN</span><span class="p">)</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_DRS</span><span class="p">(</span><span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tok</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">PROPER_NAME_DRS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ProperNameDRS</span><span class="p">(</span><span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tok</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">DEFINITE_DESCRIPTION_DRS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DefiniteDescriptionDRS</span><span class="p">(</span><span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">tok</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">PRONOUN_DRS</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PronounDRS</span><span class="p">(</span><span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span></div>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    def handle_variable(self, tok, context):</span>
<span class="sd">        # It&#39;s either: 1) a predicate expression: sees(x,y)</span>
<span class="sd">        #             2) an application expression: P(x)</span>
<span class="sd">        #             3) a solo variable: john OR x</span>
<span class="sd">        accum = self.make_VariableExpression(tok)</span>
<span class="sd">        if self.inRange(0) and self.token(0) == Tokens.OPEN:</span>
<span class="sd">            # The predicate has arguments</span>
<span class="sd">            if not isinstance(accum, FunctionVariableExpression) and not isinstance(</span>
<span class="sd">                accum, ConstantExpression</span>
<span class="sd">            ):</span>
<span class="sd">                raise LogicalExpressionException(</span>
<span class="sd">                    self._currentIndex,</span>
<span class="sd">                    &quot;&#39;%s&#39; is an illegal predicate name.  &quot;</span>
<span class="sd">                    &quot;Individual variables may not be used as &quot;</span>
<span class="sd">                    &quot;predicates.&quot; % tok,</span>
<span class="sd">                )</span>
<span class="sd">            self.token()  # swallow the Open Paren</span>

<span class="sd">            # curry the arguments</span>
<span class="sd">            accum = self.make_ApplicationExpression(</span>
<span class="sd">                accum, self.process_next_expression(APP)</span>
<span class="sd">            )</span>
<span class="sd">            while self.inRange(0) and self.token(0) == Tokens.COMMA:</span>
<span class="sd">                self.token()  # swallow the comma</span>
<span class="sd">                accum = self.make_ApplicationExpression(</span>
<span class="sd">                    accum, self.process_next_expression(APP)</span>
<span class="sd">                )</span>
<span class="sd">            self.assertNextToken(Tokens.CLOSE)</span>
<span class="sd">        return accum</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">handle_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="c1">#It&#39;s either: 1) a predicate expression: sees(x,y)</span>
        <span class="c1">#             2) an application expression: P(x)</span>
        <span class="c1">#             3) a solo variable: john OR x</span>
        <span class="n">accum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_VariableExpression</span><span class="p">(</span><span class="n">tok</span><span class="p">)</span>
        <span class="c1"># handle the feature structure of the variable</span>
        <span class="n">features</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN_BRACE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">()</span> <span class="c1"># swallow the OPEN_BRACE</span>
                <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE_BRACE</span><span class="p">:</span>
                    <span class="n">features</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DrtFeatureExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">())))</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">COMMA</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">()</span> <span class="c1"># swallow the comma</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">()</span> <span class="c1"># swallow the CLOSE_BRACE</span>
        <span class="k">except</span> <span class="n">LogicalExpressionException</span><span class="p">:</span>
            <span class="c1">#we&#39;ve reached the end of input, this constant has no features</span>
            <span class="k">pass</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">OPEN</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">features</span><span class="p">:</span>
                <span class="n">accum</span> <span class="o">=</span> <span class="n">DrtFeatureConstantExpression</span><span class="p">(</span><span class="n">accum</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="n">features</span><span class="p">)</span>
            <span class="c1">#The predicate has arguments</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">accum</span><span class="p">,</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtIndividualVariableExpression</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">LogicalExpressionException</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currentIndex</span><span class="p">,</span>
                                     <span class="s1">&#39;</span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1"> is an illegal predicate name.  &#39;</span>
                                     <span class="s1">&#39;Individual variables may not be used as &#39;</span>
                                     <span class="s1">&#39;predicates.&#39;</span> <span class="o">%</span> <span class="n">tok</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">()</span> <span class="c1">#swallow the Open Paren</span>

            <span class="c1">#curry the arguments</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_ApplicationExpression</span><span class="p">(</span><span class="n">accum</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">process_next_expression</span><span class="p">(</span><span class="n">APP</span><span class="p">))</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">inRange</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">COMMA</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">token</span><span class="p">()</span> <span class="c1">#swallow the comma</span>
                <span class="n">accum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_ApplicationExpression</span><span class="p">(</span><span class="n">accum</span><span class="p">,</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">process_next_expression</span><span class="p">(</span><span class="n">APP</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">assertNextToken</span><span class="p">(</span><span class="n">DrtTokens</span><span class="o">.</span><span class="n">CLOSE</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">features</span><span class="p">:</span>
            <span class="n">accum</span> <span class="o">=</span> <span class="n">DrtFeatureConstantExpression</span><span class="p">(</span><span class="n">accum</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Variable</span><span class="p">,</span> <span class="n">features</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">accum</span>

    <span class="k">def</span> <span class="nf">handle_DRS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">drs</span> <span class="o">=</span> <span class="n">drt</span><span class="o">.</span><span class="n">DrtParser</span><span class="o">.</span><span class="n">handle_DRS</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DRS</span><span class="p">(</span><span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">)</span>

<div class="viewcode-block" id="DrtParser.get_BooleanExpression_factory"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtParser.get_BooleanExpression_factory">[docs]</a>    <span class="k">def</span> <span class="nf">get_BooleanExpression_factory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tok</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method serves as a hook for other logic parsers that</span>
<span class="sd">        have different boolean operators&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">tok</span> <span class="o">==</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">DRS_CONC</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DrtConcatenation</span>
        <span class="k">elif</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">OR</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DrtOrExpression</span>
        <span class="k">elif</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">IMP</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DrtImpExpression</span>
        <span class="k">elif</span> <span class="n">tok</span> <span class="ow">in</span> <span class="n">DrtTokens</span><span class="o">.</span><span class="n">IFF</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">DrtIffExpression</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">make_VariableExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtVariableExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">make_ApplicationExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">function</span><span class="p">,</span> <span class="n">argument</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtApplicationExpression</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">argument</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">make_ConstantExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtConstantExpression</span><span class="p">(</span><span class="n">Variable</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">make_NegatedExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expression</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtNegatedExpression</span><span class="p">(</span><span class="n">expression</span><span class="p">)</span>

<div class="viewcode-block" id="DrtParser.make_EqualityExpression"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.DrtParser.make_EqualityExpression">[docs]</a>    <span class="k">def</span> <span class="nf">make_EqualityExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method serves as a hook for other logic parsers that</span>
<span class="sd">        have different equality expression classes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DrtEqualityExpression</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">make_LambdaExpression</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">term</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">DrtLambdaExpression</span><span class="p">(</span><span class="n">variables</span><span class="p">,</span> <span class="n">term</span><span class="p">)</span></div>


<div class="viewcode-block" id="ConditionRemover"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.ConditionRemover">[docs]</a><span class="k">class</span> <span class="nc">ConditionRemover</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generic condition remover functor to be used in readings&quot;&quot;&quot;</span>
<div class="viewcode-block" id="ConditionRemover.__init__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.ConditionRemover.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cond_index</span> <span class="o">=</span> <span class="n">cond_index</span></div>
<div class="viewcode-block" id="ConditionRemover.__call__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.ConditionRemover.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">:</span> <span class="n">DRS</span><span class="p">):</span>
        <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cond_index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">drs</span></div></div>


<div class="viewcode-block" id="VariableReplacer"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.VariableReplacer">[docs]</a><span class="k">class</span> <span class="nc">VariableReplacer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generic variable replacer functor to be used in readings</span>
<span class="sd">    </span>
<span class="sd">    :param var: replaced variable</span>
<span class="sd">    :type var: Variable</span>
<span class="sd">    :param new_var: replacement variable</span>
<span class="sd">    :type new_var: Variable</span>
<span class="sd">    :param remove_ref: remove reference (??)</span>
<span class="sd">    :type remove_ref: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="VariableReplacer.__init__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.VariableReplacer.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var</span><span class="p">:</span> <span class="n">Variable</span><span class="p">,</span> <span class="n">new_var</span><span class="p">:</span> <span class="n">Variable</span><span class="p">,</span> <span class="n">remove_ref</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="n">var</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_var</span> <span class="o">=</span> <span class="n">new_var</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_ref</span> <span class="o">=</span> <span class="n">remove_ref</span></div>

<div class="viewcode-block" id="VariableReplacer.__call__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.VariableReplacer.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">:</span> <span class="n">DRS</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DRS</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">remove_ref</span><span class="p">:</span>
            <span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">drs</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="p">,</span> <span class="p">[</span><span class="n">cond</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_var</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="ConditionReplacer"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.ConditionReplacer">[docs]</a><span class="k">class</span> <span class="nc">ConditionReplacer</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A generic condition replacer functor to be used in readings</span>
<span class="sd">    replace the condition at the given index with any number of</span>
<span class="sd">    conditions, optionally adds a referent</span>

<span class="sd">    :param index: index of the condition</span>
<span class="sd">    :type index: int</span>
<span class="sd">    :param conds: list of ``DrtExpression`` for conditions</span>
<span class="sd">    :type conds: List[DrtExpression]</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="ConditionReplacer.__init__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.ConditionReplacer.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">conds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">DrtExpression</span><span class="p">],</span> <span class="n">ref</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conds</span> <span class="o">=</span> <span class="n">conds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="n">ref</span></div>
<div class="viewcode-block" id="ConditionReplacer.__call__"><a class="viewcode-back" href="../../index.html#nltk_drt.presuppdrt.ConditionReplacer.__call__">[docs]</a>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">drs</span><span class="p">:</span> <span class="n">drt</span><span class="o">.</span><span class="n">DRS</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="p">:</span>
            <span class="n">drs</span><span class="o">.</span><span class="n">refs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref</span><span class="p">)</span>
        <span class="n">drs</span><span class="o">.</span><span class="n">conds</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conds</span>
        <span class="k">return</span> <span class="n">drs</span></div></div>

<span class="n">drt</span><span class="o">.</span><span class="n">DRS</span><span class="o">.</span><span class="n">deepcopy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
<span class="n">drt</span><span class="o">.</span><span class="n">DrtIndividualVariableExpression</span><span class="o">.</span><span class="n">deepcopy</span> <span class="o">=</span> <span class="n">DrtIndividualVariableExpression</span><span class="o">.</span><span class="n">deepcopy</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">NLTK-DRT Extension</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Fyodor Sizov, Ivan Rygaev.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>